CREATE TABLE IF NOT EXISTS bsi_queue_message
(
    ID BIGINT NOT NULL AUTO_INCREMENT,
    BODY TEXT NOT NULL,
    HEADERS TEXT NOT NULL,
    QUEUE_NAME VARCHAR(190) NOT NULL,
    CREATED_AT DATETIME NOT NULL,
    AVAILABLE_AT DATETIME NOT NULL,
    DELIVERED_AT DATETIME DEFAULT NULL,
    PRIMARY KEY (ID),
    INDEX IX_BSQM_QUEUE_NAME(QUEUE_NAME),
    INDEX IX_BSQM_AVAILABLE_AT(AVAILABLE_AT),
    INDEX IX_BSQM_DELIVERED_AT(DELIVERED_AT)
);

CREATE TABLE IF NOT EXISTS bsi_queue_message_stat
(
    ID BIGINT NOT NULL AUTO_INCREMENT,
    UUID CHAR(36) NOT NULL,
    MESSAGE VARCHAR(190) NOT NULL,
    BODY TEXT NOT NULL,
    HEADERS TEXT NOT NULL,
    STATUS VARCHAR(190) NOT NULL,
    TRANSPORT_NAME VARCHAR(190) DEFAULT NULL,
    ERROR TEXT DEFAULT NULL,
    SENT_AT DATETIME NOT NULL,
    RECEIVED_AT DATETIME DEFAULT NULL,
    HANDLED_AT DATETIME DEFAULT NULL,
    FAILED_AT DATETIME DEFAULT NULL,
    PRIMARY KEY (ID),
    UNIQUE KEY UK_BSQMS_UUID(UUID),
    INDEX IX_BSQMS_STATUS(STATUS),
    INDEX IX_BSQMS_TRANSPORT_NAME(TRANSPORT_NAME),
    INDEX IX_BSQMS_SENT_AT(SENT_AT),
    INDEX IX_BSQMS_RECEIVED_AT(RECEIVED_AT),
    INDEX IX_BSQMS_HANDLED_AT(HANDLED_AT),
    INDEX IX_BSQMS_FAILED_AT(FAILED_AT)
);