(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{369:function(t,s,a){"use strict";a.r(s);var e=a(44),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"начало-работы"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#начало-работы"}},[t._v("#")]),t._v(" Начало работы")]),t._v(" "),a("h2",{attrs:{id:"установка"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#установка"}},[t._v("#")]),t._v(" Установка")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("Требования")]),t._v(" "),a("ul",[a("li",[t._v("PHP >=7.2.5")]),t._v(" "),a("li",[t._v("1С-Битрикс >=17.5.10")]),t._v(" "),a("li",[t._v("composer/installers ^1.0")])])]),t._v(" "),a("ol",[a("li",[t._v("Настройте пути установки модулей в "),a("code",[t._v("composer.json")]),t._v(":")])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"extra"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"installer-paths"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"bitrix/modules/{$name}/"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"type:bitrix-d7-module"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("Указывается путь до папки "),a("code",[t._v("bitrix/modules")]),t._v(" относительно файла "),a("code",[t._v("composer.json")]),t._v(".")])]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("Установите модуль через "),a("a",{attrs:{href:"https://getcomposer.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Composer"),a("OutboundLink")],1),t._v(":")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("composer")]),t._v(" require bsidev/bitrix-queue\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[t._v("Перейдите в раздел Marketplace административной панели и установите модуль следуя инструкциям.")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("http://домен/bitrix/admin/partner_modules.php?id=bsi.queue&lang=ru&install=Y\n")])])]),a("h2",{attrs:{id:"настроика"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#настроика"}},[t._v("#")]),t._v(" Настройка")]),t._v(" "),a("p",[t._v("Проинициализируйте ядро модуля:")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// local/php_interface/init.php")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Bitrix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Loader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Bsi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Queue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("Loader")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includeModule")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'bsi.queue'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$queue")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("Queue")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$queue")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("boot")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"запуск-воркера"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#запуск-воркера"}},[t._v("#")]),t._v(" Запуск воркера")]),t._v(" "),a("p",[t._v("Для запуска обработки сообщений используется консольный скрипт:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("php bitrix/modules/bsi.queue/bin/console messenger:consume async --time-limit=3600\n")])])]),a("p",[a("a",{attrs:{href:"https://symfony.com/doc/current/messenger.html#consuming-messages-running-the-worker",target:"_blank",rel:"noopener noreferrer"}},[t._v("Consuming Messages (Running the Worker)"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=n.exports}}]);